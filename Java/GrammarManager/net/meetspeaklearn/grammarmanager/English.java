/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package net.meetspeaklearn.grammarmanager;

import java.util.HashMap;

/**
 *
 * @author steve
 */
public class English {
    public static HashMap<String, String> irregularPluralsMap = new HashMap<String, String>();
    
    static {
        irregularPluralsMap.put("addendum", "addenda");
        irregularPluralsMap.put("agendum", "agenda");
        irregularPluralsMap.put("aide-de-camp", "aides-de-camp");
        irregularPluralsMap.put("aircraft", "aircraft");
        irregularPluralsMap.put("airman", "airmen");
        irregularPluralsMap.put("airwoman", "airwomen");
        irregularPluralsMap.put("alga", "algae");
        irregularPluralsMap.put("aluminum", "aluminum");
        irregularPluralsMap.put("alumna", "alumnae");
        irregularPluralsMap.put("alumnus", "alumni");
        irregularPluralsMap.put("analysis", "analyses");
        irregularPluralsMap.put("anathema", "anathemata");
        irregularPluralsMap.put("antenna", "antennae");
        irregularPluralsMap.put("antithesis", "antitheses");
        irregularPluralsMap.put("apex", "apices");
        irregularPluralsMap.put("appendix", "appendices");
        irregularPluralsMap.put("aquarium", "aquaria");
        irregularPluralsMap.put("asinus", "asini");
        irregularPluralsMap.put("attorney", "attorneys");
        irregularPluralsMap.put("attorney general", "attorneys general");
        irregularPluralsMap.put("axis", "axes");
        irregularPluralsMap.put("bacillus", "bacilli");
        irregularPluralsMap.put("bacterium", "bacteria");
        irregularPluralsMap.put("basis", "bases");
        irregularPluralsMap.put("beau", "beaux");
        irregularPluralsMap.put("beau geste", "beaux gestes");
        irregularPluralsMap.put("bel-homme", "beaux hommes");
        irregularPluralsMap.put("belle epoque", "belles epoques");
        irregularPluralsMap.put("bildungsroman", "bildungsromane");
        irregularPluralsMap.put("bill of attainder", "bills of attainder");
        irregularPluralsMap.put("biscotto", "biscotti");
        irregularPluralsMap.put("bon mot", "bons mots");
        irregularPluralsMap.put("bon vivant", "bons vivants");
        irregularPluralsMap.put("bourgeois", "bourgeoisie");
        irregularPluralsMap.put("businessman", "businessmen");
        irregularPluralsMap.put("businesswoman", "businesswomen");
        irregularPluralsMap.put("boy", "boys");
        irregularPluralsMap.put("bison", "bison");
        irregularPluralsMap.put("bureau", "bureaux");
        irregularPluralsMap.put("cactus", "cacti");
        irregularPluralsMap.put("candelabrum", "candelabra");
        irregularPluralsMap.put("canto", "cantos");
        irregularPluralsMap.put("cat-o'-nine-tails", "cat-o'-nine-tails");
        irregularPluralsMap.put("chargé d'affaires", "chargés d'affaires");
        irregularPluralsMap.put("chateau", "chateaux");
        irregularPluralsMap.put("château", "châteaux");
        irregularPluralsMap.put("cattle", "cattle");
        irregularPluralsMap.put("cherub", "cherubim");
        irregularPluralsMap.put("child", "children");
        irregularPluralsMap.put("cod", "cod");
        irregularPluralsMap.put("codex", "codices");
        irregularPluralsMap.put("concerto", "concerti");
        irregularPluralsMap.put("congressman", "congressmen");
        irregularPluralsMap.put("congresswoman", "congresswomen");
        irregularPluralsMap.put("conman", "conmen");
        irregularPluralsMap.put("conwoman", "conwomen");
        irregularPluralsMap.put("corpus", "corpora");
        irregularPluralsMap.put("coup d'etat", "coups d'etat");
        irregularPluralsMap.put("court martial", "courts martial");
        irregularPluralsMap.put("craft", "craft");
        irregularPluralsMap.put("crisis", "crises");
        irregularPluralsMap.put("criterion", "criteria");
        irregularPluralsMap.put("curriculum", "curricula");
        irregularPluralsMap.put("datum", "data");
        irregularPluralsMap.put("deer", "deer");
        irregularPluralsMap.put("desideratum", "desiderata");
        irregularPluralsMap.put("diagnosis", "diagnoses");
        irregularPluralsMap.put("die", "dice");
        irregularPluralsMap.put("director general", "directors general");
        irregularPluralsMap.put("dogma", "dogmata");
        irregularPluralsMap.put("dwarf", "dwarves");
        irregularPluralsMap.put("ellipsis", "ellipses");
        irregularPluralsMap.put("donkey", "donkeys");
        irregularPluralsMap.put("emphasis", "emphases");
        irregularPluralsMap.put("entente cordiale", "ententes cordiales");
        irregularPluralsMap.put("envoy", "envoys");
        irregularPluralsMap.put("equus", "equi");
        irregularPluralsMap.put("erratum", "errata");
        irregularPluralsMap.put("fait accompli", "faits accomplis");
        irregularPluralsMap.put("faux pas", "faux pas");
        irregularPluralsMap.put("fee simple absolute", "fees simple absolute");
        irregularPluralsMap.put("fez", "fezzes");
        irregularPluralsMap.put("fireman", "firemen");
        irregularPluralsMap.put("firewoman", "firewomen");
        irregularPluralsMap.put("fish", "fish");
        irregularPluralsMap.put("focus", "foci");
        irregularPluralsMap.put("foot", "feet");
        irregularPluralsMap.put("formula", "formulae");
        irregularPluralsMap.put("fungus", "fungi");
        irregularPluralsMap.put("gas", "gasses");
        irregularPluralsMap.put("gens", "gentes");
        irregularPluralsMap.put("genu", "genua");
        irregularPluralsMap.put("genus", "genera");
        irregularPluralsMap.put("goose", "geese");
        irregularPluralsMap.put("governor-general", "governors-general");
        irregularPluralsMap.put("graffito", "graffiti");
        irregularPluralsMap.put("grouse", "grouse");
        irregularPluralsMap.put("gymnasium", "gymnasia");
        irregularPluralsMap.put("half", "halves");
        irregularPluralsMap.put("hallux", "halluces");
        irregularPluralsMap.put("ham on rye", "hams on rye");
        irregularPluralsMap.put("head of state", "heads of states");
        irregularPluralsMap.put("hoof", "hooves");
        irregularPluralsMap.put("hetero", "heteros");
        irregularPluralsMap.put("hippopotamus", "hippopotami");
        irregularPluralsMap.put("holluschik", "holluschikie");
        irregularPluralsMap.put("hypothesis", "hypotheses");
        irregularPluralsMap.put("index", "indices");
        irregularPluralsMap.put("insigne", "insignia");
        irregularPluralsMap.put("iter", "itinera");
        irregularPluralsMap.put("jack-in-the-box", "jacks-in-the-box");
        irregularPluralsMap.put("jack-in-the-pulpit", "	jacks-in-the-pulpit");
        irregularPluralsMap.put("jack-o'-lantern", "jack-o'-lanterns");
        irregularPluralsMap.put("jacques", "jacques");
        irregularPluralsMap.put("kimono", "kimonos");
        irregularPluralsMap.put("kin", "kin");
        irregularPluralsMap.put("krone", "kroner");
        irregularPluralsMap.put("larva", "larvae");
        irregularPluralsMap.put("lemma", "lemmata");
        irregularPluralsMap.put("libretto", "libretti");
        irregularPluralsMap.put("loaf", "loaves");
        irregularPluralsMap.put("locus", "loci");
        irregularPluralsMap.put("louse", "lice");
        irregularPluralsMap.put("man", "men");
        irregularPluralsMap.put("man-about-town", "men-about-town");
        irregularPluralsMap.put("man-child", "men-children");
        irregularPluralsMap.put("man-of-war", "men-of-war");
        irregularPluralsMap.put("manservant", "menservants");
        irregularPluralsMap.put("matrix", "matrices");
        irregularPluralsMap.put("matzo", "matzoth");
        irregularPluralsMap.put("maximum", "maxima");
        irregularPluralsMap.put("medium", "media");
        irregularPluralsMap.put("means", "means");
        irregularPluralsMap.put("medium", "media");
        irregularPluralsMap.put("memorandum", "memoranda");
        irregularPluralsMap.put("millennium", "millennia");
        irregularPluralsMap.put("minimum", "minima");
        irregularPluralsMap.put("minister-president", "ministers-president");
        irregularPluralsMap.put("minutia", "minutiae");
        irregularPluralsMap.put("moose", "moose");
        irregularPluralsMap.put("moratorium", "moratoria");
        irregularPluralsMap.put("mouse", "mice");
        irregularPluralsMap.put("nebula", "nebulae");
        irregularPluralsMap.put("neurosis", "neuroses");
        irregularPluralsMap.put("never-was", "never-weres");
        irregularPluralsMap.put("nucleus", "nuclei");
        irregularPluralsMap.put("oasis", "oases");
        irregularPluralsMap.put("octopus", "octopi");
        irregularPluralsMap.put("offspring", "offspring");
        irregularPluralsMap.put("opus", "opera");
        irregularPluralsMap.put("ornis", "ornithes");
        irregularPluralsMap.put("ovum", "ova");
        irregularPluralsMap.put("ox", "oxen");
        irregularPluralsMap.put("oz", "oz");
        irregularPluralsMap.put("panino", "panini");
        irregularPluralsMap.put("paparazzo", "paparazzi");
        irregularPluralsMap.put("paralysis", "paralyses");
        irregularPluralsMap.put("parenthesis", "parentheses");
        irregularPluralsMap.put("passerby", "passersby");
        irregularPluralsMap.put("penny", "pence");
        irregularPluralsMap.put("percent", "percent");
        irregularPluralsMap.put("person", "people");
        irregularPluralsMap.put("phenomenon", "phenomena");
        irregularPluralsMap.put("phylum", "phyla");
        irregularPluralsMap.put("phoenix", "phoenix");
        irregularPluralsMap.put("photo", "photos");
        irregularPluralsMap.put("piano", "pianos");
        irregularPluralsMap.put("plateau", "plateaux");
        irregularPluralsMap.put("policeman", "policemen");
        irregularPluralsMap.put("policewoman", "policewomen");
        irregularPluralsMap.put("portico", "porticos");
        irregularPluralsMap.put("postman", "postmen");
        irregularPluralsMap.put("postwoman", "postwomen");
        irregularPluralsMap.put("pro", "pros");
        irregularPluralsMap.put("procurator fiscal", "procurators fiscal");
        irregularPluralsMap.put("proletarian", "proletariat");
        irregularPluralsMap.put("quadrans", "quadrantes");
        irregularPluralsMap.put("quarto", "quartos");
        irregularPluralsMap.put("quiz", "quizzes");
        irregularPluralsMap.put("radius", "radii");
        irregularPluralsMap.put("referendum", "referenda");
        irregularPluralsMap.put("rubai", "rubaiyat");
        irregularPluralsMap.put("runner-up", "runners-up");
        irregularPluralsMap.put("salesman", "salesmen");
        irregularPluralsMap.put("saleswoman", "saleswomen");
        irregularPluralsMap.put("salmon", "salmon");
        irregularPluralsMap.put("scarf", "scarves");
        irregularPluralsMap.put("schema", "schemata");
        irregularPluralsMap.put("scissors", "scissors");
        irregularPluralsMap.put("scrotum", "scrota");
        irregularPluralsMap.put("self", "selves");
        irregularPluralsMap.put("seraph", "seraphim");
        irregularPluralsMap.put("series", "series");
        irregularPluralsMap.put("sheep", "sheep");
        irregularPluralsMap.put("ship of the line", "ships of the line");
        irregularPluralsMap.put("shrimp", "shrimp");
        irregularPluralsMap.put("shtetl", "shtetlach");
        irregularPluralsMap.put("son of a bitch", "sons of bitches");
        irregularPluralsMap.put("son-in-law", "sons-in-law");
        irregularPluralsMap.put("spaceman", "spacemen");
        irregularPluralsMap.put("spacewoman", "spacewomen");
        irregularPluralsMap.put("spaghetto", "spaghetti");
        irregularPluralsMap.put("species", "species");
        irregularPluralsMap.put("sperm", "sperm");
        irregularPluralsMap.put("stigma", "stigmata");
        irregularPluralsMap.put("stimulus", "stimuli");
        irregularPluralsMap.put("stoma", "stomata");
        irregularPluralsMap.put("stratum", "strata");
        irregularPluralsMap.put("swine", "swine");
        irregularPluralsMap.put("syllabus", "syllabi");
        irregularPluralsMap.put("symposium", "symposia");
        irregularPluralsMap.put("synopsis", "synopses");
        irregularPluralsMap.put("tableau", "tableaux");
        irregularPluralsMap.put("tete-a-tete", "tete-a-tetes");
        irregularPluralsMap.put("that", "those");
        irregularPluralsMap.put("thesis", "theses");
        irregularPluralsMap.put("thief", "thieves");
        irregularPluralsMap.put("this", "these");
        irregularPluralsMap.put("tooth", "teeth");
        irregularPluralsMap.put("torte", "torten");
        irregularPluralsMap.put("tour de force", "tours de force");
        irregularPluralsMap.put("toy", "toys");
        irregularPluralsMap.put("trout", "trout");
        irregularPluralsMap.put("tuna", "tuna");
        irregularPluralsMap.put("ushabti", "ushabtiu");
        irregularPluralsMap.put("vagina", "vaginae");
        irregularPluralsMap.put("vas", "vasa");
        irregularPluralsMap.put("vertebra", "vertebrae");
        irregularPluralsMap.put("vertex", "vertices");
        irregularPluralsMap.put("vita", "vitae");
        irregularPluralsMap.put("vortex", "vortices");
        irregularPluralsMap.put("wharf", "wharves");
        irregularPluralsMap.put("wife", "wives");
        irregularPluralsMap.put("will-o'-the-wisp", "will-o'-the-wisps");
        irregularPluralsMap.put("wolf", "wolves");
        irregularPluralsMap.put("woman", "women");
        irregularPluralsMap.put("woman doctor", "woman doctors");
        irregularPluralsMap.put("wunderkind", "wunderkinder");
        irregularPluralsMap.put("yen", "yen");
        irregularPluralsMap.put("yeshiva", "yeshivoth");
        irregularPluralsMap.put("yuan", "yuan");
        irregularPluralsMap.put("zecchino", "zecchini");
    }
    
    public static boolean isCapitalized(String s) {
        int len = s.length();
        
        if (len == 0) return false;
        
        char firstChar = s.charAt(0);
        
        return (('A' <= firstChar) && (firstChar <= 'Z'));
    }
    
    public static boolean isAllUppercase(String s) {
        int len = s.length();
        char c;
        
        if (len == 0) return false;
        
        for (int i = 0; i < len; i++) {
            c = s.charAt(i);
            
            if (! (('A' <= c) && (c <= 'Z'))) return false;
        }
        
        return true;
    }
    
    public static boolean isAllLowercase(String s) {
        int len = s.length();
        char c;
        
        if (len == 0) return false;
        
        for (int i = 0; i < len; i++) {
            c = s.charAt(i);
            
            if (! (('a' <= c) && (c <= 'a'))) return false;
        }
        
        return true;
    }
    
    public static String restoreCase(String s, String p) {
        int pLen = p.length();
        char c;
        char[] charVector;
        
        if (isAllUppercase(s)) return p.toUpperCase();
        if (isCapitalized(s)) {
            charVector = new char[pLen];
            for (int i = 0; i < pLen; i++) {
                c = p.charAt(i);
                
                if (i == 0) {
                    charVector[i] = Character.toUpperCase(c);
                } else {
                    charVector[i] = Character.toLowerCase(c);
                }
            }
            
            return String.valueOf(charVector);
        }
        
        charVector = new char[pLen];
        int sLen = s.length();
        boolean lastCharWasLower = false;
        
        for (int i = 0; i < pLen; i++) {
            c = p.charAt(i);
            if (Character.isAlphabetic(c)) {
                if (i < sLen) {
                    if (Character.isUpperCase(s.charAt(i))) {
                        lastCharWasLower = false;
                        charVector[i] = Character.toUpperCase(c);
                    } else {
                        lastCharWasLower = true;
                        charVector[i] = Character.toLowerCase(c);
                    }
                } else if (lastCharWasLower) {
                    charVector[i] = Character.toLowerCase(c);
                } else {
                    charVector[i] = Character.toUpperCase(c);
                }
            } else {
                charVector[i] = c;
            }
        }
        
        return String.valueOf(charVector);
    }
    
    public static boolean isVowel(char c) {
        c = Character.toLowerCase(c);
        return ((c == 'a') || (c == 'e') || (c == 'i') || (c == 'o') || (c == 'u'));
    }
    
    public static boolean isConsonant(char c) {
        c = Character.toLowerCase(c);
        if (! Character.isAlphabetic(c)) return false;
        return ((c != 'a') && (c != 'e') && (c != 'i') && (c != 'o') && (c != 'u'));
    }
    
    public static String pluralizeNoun(String singularForm) {
        String sfLower = singularForm.toLowerCase();
        String sfLowerPlural = sfLower;
        boolean pluralized = false;
        
        if (irregularPluralsMap.containsKey(sfLower))
            return restoreCase(singularForm, irregularPluralsMap.get(sfLower));
        
        // craft
        
        int len = singularForm.length();
        
        if (len == 0) return singularForm;
        
        if (len >= 5) {
            String lastFive = sfLower.substring(len - 5);
            
            if ((lastFive.compareTo("craft") == 0)
                    || (lastFive.compareTo("corps") == 0)) {
                return restoreCase(singularForm, sfLower);
            }
        }
        
        if (len == 1) {
            // I know of no such words that can pluralized except "I".
            
            if (singularForm.compareTo("I") == 0) {
                return "you";
            }
            
            return singularForm;
        } else if (len >= 1) {
            String lastOne = sfLower.substring(len - 1);
            String lastTwo = sfLower.substring(len - 2);
            String lastThree = null;
            
            if (len >= 2) {
                lastThree = sfLower.substring(len - 3);
            }
            
            if (lastThree != null) {
                if ((lastThree.compareTo("ief") == 0)
                        || (lastThree.compareTo("oof") == 0)
                        || (lastThree.compareTo("eef") == 0)) {
                    sfLowerPlural = sfLower + "s";
                    pluralized = true;
                }
            }
            
            if (! pluralized) {
                if ((lastTwo.compareTo("ff") == 0)
                        || (lastTwo.compareTo("rf") == 0)) {
                    sfLowerPlural = sfLower + "s";
                    pluralized = true;
                }
            }
            
            if (! pluralized) {
                if (lastTwo.compareTo("fe") == 0) {
                    sfLowerPlural = sfLower.substring(0, len - 2) + "ves";
                    pluralized = true;
                }
            }
            
            if (! pluralized) {
                if ((lastTwo.compareTo("sh") == 0)
                        || (lastTwo.compareTo("ss") == 0)
                        || (lastTwo.compareTo("ch") == 0)) {
                    sfLowerPlural = sfLower + "es";
                    pluralized = true;
                }
            }
            
            if (! pluralized) {
                if ((lastOne.charAt(0) == 'o')) {
                    if (isVowel(lastTwo.charAt(0))) {
                        sfLowerPlural = sfLower + "s";
                        pluralized = true;
                    } else if (isConsonant(lastTwo.charAt(0))) {
                        sfLowerPlural = sfLower + "es";
                        pluralized = true;
                    }
                } else if ((lastOne.charAt(0) == 's')) {
                        sfLowerPlural = sfLower + "es";
                        pluralized = true;
                } else if ((lastOne.charAt(0) == 'x')) {
                        sfLowerPlural = sfLower + "es";
                        pluralized = true;
                } else if ((lastOne.charAt(0) == 'y')) {
                        sfLowerPlural = sfLower.substring(0, len - 1) + "ies";
                        pluralized = true;
                }
            }
                
            if (! pluralized) {
                sfLowerPlural = sfLower + "s";
                pluralized = true;
            }
        }
            
        return restoreCase(singularForm, sfLowerPlural);
    }
}
